/*==============================================================================
 Program: data_refine.do
 Creator: Lin
 Created: 2021/03/11
 Updated: 
 Purpose: Ghana GWR data 
==============================================================================*/

set more off
global dir = "D:/00_work/07_GWR_Ghana"

/*==============================================================================
Step0: 2007~2011_GWR_GH_data.py
利用python把NA, EU, CHINA以外的PM2.5抓出來，但還沒有把lon跟lat跟PM2.5 merge。
==============================================================================*/
* 2007~2011_GWR_GH_data.py


/*==============================================================================
Step1: merge_GWR_data.do
切割出Ghana範圍並將lat lon pm25 1:1merge，再整理成一份及調整格式。
==============================================================================*/
do "$dir/programs/merge_GWR_data.do"


/*==============================================================================
Step2: district.py
判斷2007~2011_GWR_Ghana_pm25_grid-year.dta裡的每個座標在哪個district。
==============================================================================*/
*district.py


/*==============================================================================
Step3: distcode.do
將Step2跑出的區域(shapefile名稱)對應到codebook內district code。
==============================================================================*/
do "$dir/programs/distcode.do"


/*==============================================================================
Step4: dist_ave.do
算各區年平均pm25並產生群組資料dta在do file所在資料夾。
==============================================================================*/
do "$dir/programs/dist_ave.do"


/*==============================================================================
Step5: merge_hhid_ave.do
透過dist year 將問卷基本資料(日期、hhid)和pm25資料merge以及算出lg ld 6個月。
==============================================================================*/
do "$dir/programs/merge_hhid_ave.do"


/*==============================================================================
Step5: merge_pm25_ques.do
透過hhid將問卷(K10,出生年等)和step5資料merge。
==============================================================================*/
do "$dir/programs/merge_pm25_ques.do.do"
